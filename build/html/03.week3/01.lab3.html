<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.1. Lab 03: Conditional Redirection And Environment (ENVs &amp; Aliases) &mdash; ist5001 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=cd5dafa7" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.2. Homework 03: Grep, Alias, Env Var, &amp; Function" href="02.homework3.html" />
    <link rel="prev" title="4. Week 3" href="week3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ist5001
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../00.week0/week0.html">1. week 0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01.week1/week1.html">2. Week 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.week2/week2.html">3. Week 2</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="week3.html">4. Week 3</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.1. Lab 03: Conditional Redirection And Environment (ENVs &amp; Aliases)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assignment-instruction">4.1.1. Assignment Instruction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-started">4.1.2. Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="#when-you-are-done">4.1.3. When You Are Done</a></li>
<li class="toctree-l3"><a class="reference internal" href="#note">4.1.4. Note</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">4.1.5. Note</a></li>
<li class="toctree-l3"><a class="reference internal" href="#part-0-introduction">4.1.6. Part 0. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#steps">4.1.7. Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preparation">4.1.8. Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#part-1-conditional-redirection">4.1.9. Part 1. Conditional Redirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backup-first">4.1.10. Backup first</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backup-copy-and-working-copy">4.1.11. 1.1 Backup Copy And Working Copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-backup-copy">4.1.12. A. Backup copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-working-copy">4.1.13. B. Working copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditional-redirection">4.1.14. 1.2 Conditional Redirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-your-work">4.1.15. Check Your Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tile-two-terminals">4.1.16. Tile two terminals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#o">4.1.17. ^-O</a></li>
<li class="toctree-l3"><a class="reference internal" href="#part-2-environment-envs-and-aliases-at-user-level">4.1.18. Part 2. Environment: ENVs And Aliases At User Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-environment-variables-and-aliases">4.1.19. 2.1 Create Environment Variables And Aliases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-bash-aliases">4.1.20. 2.2 Create .Bash_aliases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#part-3-putting-it-all-together">4.1.21. Part 3. Putting It All Together</a></li>
<li class="toctree-l3"><a class="reference internal" href="#putting-it-all-together">4.1.22. Putting It All Together</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="02.homework3.html">4.2. Homework 03: Grep, Alias, Env Var, &amp; Function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04.week4/week4.html">5. Week 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.week5/week5.html">6. Week 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06.week6/week6.html">7. Week 6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07.week7/week7.html">8. Week 7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08.appendix/appendix.html">9. Appendix</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ist5001</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="week3.html"><span class="section-number">4. </span>Week 3</a></li>
      <li class="breadcrumb-item active"><span class="section-number">4.1. </span>Lab 03: Conditional Redirection And Environment (ENVs &amp; Aliases)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/03.week3/01.lab3.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lab-03-conditional-redirection-and-environment-envs-aliases">
<h1><span class="section-number">4.1. </span>Lab 03: Conditional Redirection And Environment (ENVs &amp; Aliases)<a class="headerlink" href="#lab-03-conditional-redirection-and-environment-envs-aliases" title="Link to this heading"></a></h1>
<section id="assignment-instruction">
<h2><span class="section-number">4.1.1. </span>Assignment Instruction<a class="headerlink" href="#assignment-instruction" title="Link to this heading"></a></h2>
<p>To successfully complete this assignment, you are advised to pay attention to the following:</p>
<ol class="arabic simple">
<li><p><strong>Follow instructions:</strong> Read, interpret, and follow instructions very carefully. Finish reading the whole question and note the requirements before you start working on the question.</p></li>
<li><p><strong>Use resources:</strong> You may use any resources available to you via the web. You are encouraged to discuss the problems with others before you sit down and attempt to answer the questions.</p></li>
<li><p><strong>Work independently:</strong> While you are completing the questions, you are expected to work on your own without direct help from other people (non-human resources such as search engines are still allowed).</p></li>
<li><p><strong>Work together:</strong> Come to the office hours to work as a group on the interpretation of and solutions to questions. When using text messaging, attach screenshots.</p></li>
<li><p><strong>For introduction to basic Linux and shell commands and special characters, see:</strong>
- <a class="reference external" href="https://bashnet.org/docs/linux_shell_commands.php">Linux &amp; shell basic commands</a>
- <a class="reference external" href="https://bashnet.org/docs/linux_special_characters.php">Linux &amp; shell special characters</a></p></li>
</ol>
</section>
<section id="getting-started">
<h2><span class="section-number">4.1.2. </span>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>class directory:</strong> To begin this assignment, make sure you navigate into the class directory under your user home directory.</p></li>
<li><p><strong>scp the tar file:</strong> Use <cite>scp</cite> to copy the tar file <cite>a03.tar.gz</cite> from <cite>datacenter&#64;tychen.us</cite> to your <cite>~/class</cite> directory. The command is: <cite>scp datacenter&#64;tychen.us:~/class/labs/a03.tar.gz .</cite> (### don’t forget the “ . ” at the end of the command) and the password is <cite>InCharge56!</cite></p></li>
<li><p><strong>unzip the tar file:</strong> Extract the contents of the tar file: <cite>tar -xf a03.tar.gz</cite>. Once the files are extracted, you should see the <cite>a03</cite> folder (a directory containing several directories and files) in your class directory. These are the files you need to complete this assignment.</p></li>
<li><p><strong>a03:</strong> Unless otherwise specified in the question, all file names are given relative to the directory <cite>~/class/a03</cite>.</p></li>
<li><p><strong>Passwords:</strong> All the account names and the corresponding passwords are recorded in Canvas Assignment <cite>a00</cite>, where you keep them updated.</p></li>
</ol>
</section>
<section id="when-you-are-done">
<h2><span class="section-number">4.1.3. </span>When You Are Done<a class="headerlink" href="#when-you-are-done" title="Link to this heading"></a></h2>
<p>When you have completed the assignment:</p>
<ol class="arabic simple">
<li><p><strong>done.sh:</strong> Run the script <cite>done.sh</cite> in <cite>~/class</cite> as follows:
<cite>./done.sh firstname lastname a03</cite> (The <cite>done.sh</cite> script is part of Assignment <cite>h01</cite>.)</p></li>
<li><p><strong>lab03.txt:</strong> The <cite>done.sh</cite> script will check your answers and create a new .txt called <cite>lab03.txt</cite> in the <cite>a03</cite> directory that you will need to submit to Canvas for assignment <cite>a03</cite>.</p></li>
<li><p><strong>Download lab03.txt to submit to Canvas:</strong> From your local computer terminal (cmd or PowerShell for Windows and Terminal for macOS), change into a folder (e.g., <cite>cd Documents</cite> to go into your Documents folder). Use the <cite>scp</cite> command to copy your submission file from your VM to your local computer’s Documents folder:
<cite>scp YOUR_USERNAME&#64;YOUR_VM_IP_ADDRESS:~/class/a03/lab03.txt .</cite></p></li>
</ol>
</section>
<section id="note">
<h2><span class="section-number">4.1.4. </span>Note<a class="headerlink" href="#note" title="Link to this heading"></a></h2>
<p>You can run the <cite>done.sh</cite> script at any point when you are working on the assignment and the content of the generated <cite>lab03.txt</cite> may be helpful in addition to the check scripts in each question. However, you must run it just prior to submitting the generated <cite>lab03.txt</cite> file in your <cite>class/a03</cite> directory to Canvas to make sure you are submitting the most recent file.</p>
</section>
<section id="id1">
<h2><span class="section-number">4.1.5. </span>Note<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>To see your VM’s IP address, run <cite>ip addr</cite> or <cite>ifconfig</cite> (installation of net-tools required).</p>
</section>
<section id="part-0-introduction">
<h2><span class="section-number">4.1.6. </span>Part 0. Introduction<a class="headerlink" href="#part-0-introduction" title="Link to this heading"></a></h2>
<p>This assignment continues with Linux and expands on what you have learned about Linux scripts. The learning objectives include:</p>
<ul class="simple">
<li><p>Learning how to take user input for scanning and logging files</p></li>
<li><p>Modifying your working environment using <cite>.bash_aliases</cite></p></li>
<li><p>Putting user input, file scanning/logging, and <cite>.bash_aliases</cite> into one script</p></li>
</ul>
<p>It is often necessary to create a set of Linux commands as an environment (including environment variables, aliases, and functions/scripts) that provide administrative users with simple ways to complete those otherwise tedious and repetitive tasks. In this assignment, we will learn some common practices of how Linux system administrators customize their Linux environment to make their life easier. The skills and concepts you learn from this activity will help you see from the perspective of information systems administration. Such an experience is a proof that you have the foundational knowledge of Linux systems and shell scripting, which assures your prospective employers that you are comfortable with the technical aspects of the job you are seeking.</p>
<p>Your personal environment is loaded when you log into a computer (when the default configurations are read from various configuration files and executed). You have some control over what goes into your environment via modifying the configurations in the files such as <cite>/etc/environment</cite>, <cite>/etc/profile</cite>, <cite>~/.bashrc</cite>, <cite>~/.profile</cite>, and <cite>~/.bash_aliases</cite>. In this activity, we will modify that configuration by creating an additional file specifically to expand the Linux environment for this assignment. To do this we must:</p>
</section>
<section id="steps">
<h2><span class="section-number">4.1.7. </span>Steps<a class="headerlink" href="#steps" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Create the directories and scripts needed to implement our new tools,</p></li>
<li><p>Create a script to catch user input and perform file scanning,</p></li>
<li><p>Create a script to redirect command results into specified logs,</p></li>
<li><p>Create a file <cite>~/myenv</cite> to hold the commands that create our assignment-specific environment variables and aliases, and</p></li>
<li><p>Create the <cite>./.bash_aliases</cite> file and modify it to include the file, <cite>~/myenv</cite>; and finally, we will</p></li>
<li><p>Verify that everything works as designed.</p></li>
</ol>
</section>
<section id="preparation">
<h2><span class="section-number">4.1.8. </span>Preparation<a class="headerlink" href="#preparation" title="Link to this heading"></a></h2>
<p>To prepare for this activity, you will need to create two directories called <cite>tmp</cite> and <cite>backup</cite> in your home directory. Also, you should have created a user <cite>bin</cite> directory as part of Lab Activity 2.</p>
<ul class="simple">
<li><p>Create the <cite>tmp</cite> and <cite>backup</cite> directories in your user home directory (NOT the root home, or “/home”, but your user home directory). Using the <cite>mkdir directory1 directory2 …</cite> syntax, you can create multiple directories at once.</p></li>
<li><p>If you didn’t create a <cite>bin</cite> directory as part of Activity 2, do so now.</p></li>
</ul>
</section>
<section id="part-1-conditional-redirection">
<h2><span class="section-number">4.1.9. </span>Part 1. Conditional Redirection<a class="headerlink" href="#part-1-conditional-redirection" title="Link to this heading"></a></h2>
<p>The <cite>finder_v00.sh</cite> script:</p>
<p>There is a file called <cite>finder_v00.sh</cite> within your <cite>a03/q01</cite> directory. This script can be modified to check for a specific file or directory in every user’s home directory, which is a common administrative task to perform. For example, <cite>finder_v00.sh</cite> can be used to see if all of the users have set up a <cite>backup</cite>, <cite>class</cite>, <cite>public_html</cite>, <cite>tmp</cite>, or <cite>bin</cite> directory. Using a script like <cite>finder_v00.sh</cite>, an administrator can automatically check the status of the user accounts in batch.</p>
</section>
<section id="backup-first">
<h2><span class="section-number">4.1.10. </span>Backup first<a class="headerlink" href="#backup-first" title="Link to this heading"></a></h2>
<p>To accomplish this, the <cite>finder_v00.sh</cite> script needs to be modified. But we don’t usually modify files directly; instead, we make sure we have two copies of the file: a backup copy and a working copy. We make modifications on the working copy only, so we always have the original file to fall back to in case the task does not go as planned. In other words, we will at least not make things worse.</p>
<p>Use the directory <cite>~/class/a03/q01</cite> to record your answers for this part of the assignment.</p>
</section>
<section id="backup-copy-and-working-copy">
<h2><span class="section-number">4.1.11. </span>1.1 Backup Copy And Working Copy<a class="headerlink" href="#backup-copy-and-working-copy" title="Link to this heading"></a></h2>
</section>
<section id="a-backup-copy">
<h2><span class="section-number">4.1.12. </span>A. Backup copy<a class="headerlink" href="#a-backup-copy" title="Link to this heading"></a></h2>
<p>Let us start by <cite>cp</cite> the file <cite>finder_v00.sh</cite> into your <cite>backup</cite> directory. Also, let us double-check to make sure it’s there by issuing the <cite>ls</cite> command:</p>
<ul class="simple">
<li><p><cite>cp</cite> the file to the <cite>backup</cite> directory</p></li>
<li><p>issuing <cite>ls -l ~/backup/finder_v00.sh</cite> to make sure the backup file is present in the intended directory.</p></li>
</ul>
</section>
<section id="b-working-copy">
<h2><span class="section-number">4.1.13. </span>B. Working copy<a class="headerlink" href="#b-working-copy" title="Link to this heading"></a></h2>
<p>We are going to rename the script to a working copy because we want to be clear we are working on the right file. This may seem trivial, but it could save a day when things get hectic and you don’t even know if you could rely on the timestamps (use <cite>ls -l</cite> to see) to tell which file(s) are the working files. So, let us <cite>cp</cite> (or <cite>mv</cite>) <cite>finder_v00.sh</cite> to <cite>q01.sh</cite> as your working copy for accomplishing the required modifications.</p>
<ul class="simple">
<li><p><cite>cp</cite> or <cite>mv</cite> <cite>finder_v00.sh</cite> to <cite>q01.sh</cite>.</p></li>
</ul>
</section>
<section id="conditional-redirection">
<h2><span class="section-number">4.1.14. </span>1.2 Conditional Redirection<a class="headerlink" href="#conditional-redirection" title="Link to this heading"></a></h2>
<ol class="upperalpha simple">
<li><p>Run sample script <code class="docutils literal notranslate"><span class="pre">user_input.sh</span></code></p></li>
</ol>
<p>Stand on the shoulders of your predecessors! In general, programmers spend more time in reading/reusing/fixing/enhancing the code written by their colleagues. In our case, we have two short scripts (<code class="docutils literal notranslate"><span class="pre">user_input.sh</span></code> and <code class="docutils literal notranslate"><span class="pre">redirect.sh</span></code>) in the <code class="docutils literal notranslate"><span class="pre">q01</span></code> directory, they provide examples of how to implement the changes you need. Let’s run <code class="docutils literal notranslate"><span class="pre">user_input.sh</span></code> first:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chen_user2@vma50:~/class/a03/q01$<span class="w"> </span>./user_input.sh
Please<span class="w"> </span>enter<span class="w"> </span>your<span class="w"> </span>last<span class="w"> </span>name:<span class="w"> </span>Chen
Hello.<span class="w"> </span>Is<span class="w"> </span>this<span class="w"> </span>your<span class="w"> </span>last<span class="w"> </span>name:<span class="w"> </span>Chen?
chen_user2@vma50:~/class/a03/q01$
</pre></div>
</div>
<p>We see that this script was written to interact with the user by prompting the user for their last name and will respond to user input by greeting the user and asking a question.</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">./user_input.sh</span></code> to observe the behavior.</p>
<ol class="upperalpha simple" start="2">
<li><p>Observe sample script <code class="docutils literal notranslate"><span class="pre">user_input.sh</span></code></p></li>
</ol>
<p>Now let’s observe the file by <code class="docutils literal notranslate"><span class="pre">nano</span> <span class="pre">user_input.sh</span></code>. You will see:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">01</span><span class="w"> </span><span class="c1">#!/bin/bash</span>
<span class="m">02</span><span class="w"> </span><span class="c1">#</span>
<span class="m">03</span><span class="w"> </span><span class="c1">#       Sample script to demonstrate getting user input from the terminal</span>
<span class="m">04</span><span class="w"> </span><span class="c1">#</span>
<span class="m">05</span><span class="w"> </span><span class="c1">#       Sample script with no editing of the input and no default</span>
<span class="m">06</span><span class="w"> </span><span class="c1">#</span>
<span class="m">07</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;Please enter your last name: &quot;</span>
<span class="m">08</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>name
<span class="m">09</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hello. Is this your last name: </span><span class="nv">$name</span><span class="s2">?&quot;</span>
</pre></div>
</div>
<p>We see that:</p>
<ol class="arabic simple">
<li><p>The script starts with a shebang line at line #1, and followed by a bunch of comments.</p></li>
<li><p>Line #7 is an echo line, which will print the prompt message to the terminal. The <code class="docutils literal notranslate"><span class="pre">-n</span></code> option instructs the shell not to output the trailing newline.</p></li>
<li><p>Line #8 is an input (<code class="docutils literal notranslate"><span class="pre">read</span></code>) line that takes “name” as a variable to point to the value from user input.</p></li>
<li><p>Line #9 is another echo line that prints out the message we want. Note that, inside the message, variable <code class="docutils literal notranslate"><span class="pre">name</span></code> is referenced as <code class="docutils literal notranslate"><span class="pre">$name</span></code>, not <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">nano</span> <span class="pre">user_input.sh</span></code> to read the code line by line to understand what it’s doing.</p>
<ol class="upperalpha simple" start="3">
<li><p>Run and observe <code class="docutils literal notranslate"><span class="pre">redirect.sh</span></code></p></li>
</ol>
<p>Let’s run and observe <code class="docutils literal notranslate"><span class="pre">redirect.sh</span></code>. When we do <code class="docutils literal notranslate"><span class="pre">./redirect.sh</span></code> and follow the prompt to enter <code class="docutils literal notranslate"><span class="pre">a01.txt</span></code>, which is a file we know exists in the directory, we see:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chen_user2@vma50:~/class/a03/q01$<span class="w"> </span>./redirect.sh
Please<span class="w"> </span>enter<span class="w"> </span>a<span class="w"> </span>filename:<span class="w"> </span>a01.txt
chen_user2@vma50:~/class/a03/q01$
</pre></div>
</div>
<p>The file did not give us any further feedback. However, if we <code class="docutils literal notranslate"><span class="pre">ls</span></code> the directory, we see an additional file, <code class="docutils literal notranslate"><span class="pre">success.log</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>a01.bak<span class="w">  </span>check01.sh<span class="w">   </span>redirect.sh<span class="w">  </span>user_input.sh
a01.txt<span class="w">  </span>error.log<span class="w">   </span>finder_v00.sh<span class="w">  </span>success.log
</pre></div>
</div>
<p>Now let’s take a look at the content of <code class="docutils literal notranslate"><span class="pre">success.log</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chen_user2@vma50:~/class/a03/q01$<span class="w"> </span>cat<span class="w"> </span>success.log
This<span class="w"> </span>file<span class="w"> </span>logs<span class="w"> </span>commands<span class="w"> </span>that<span class="w"> </span>succeed
a01.txt
We<span class="w"> </span>looked<span class="w"> </span><span class="k">for</span><span class="w"> </span>file<span class="w"> </span>a01.txt
chen_user2@vma50:~/class/a03/q01$
</pre></div>
</div>
<p>Obviously, script <code class="docutils literal notranslate"><span class="pre">redirect.sh</span></code> redirected some text into the file <code class="docutils literal notranslate"><span class="pre">success.log</span></code>. Now let us take a look at the content of the script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">01</span><span class="w"> </span><span class="c1">#!/bin/bash</span>
<span class="m">02</span>
<span class="m">03</span><span class="w"> </span><span class="c1"># This script provides a simple example of how to redirect output resulting</span>
<span class="m">04</span><span class="w"> </span><span class="c1"># from commands that execute properly and commands that do not.</span>
<span class="m">05</span>
<span class="m">06</span><span class="w"> </span><span class="c1">##### prompt (-n: no newline) and input-&gt;variable</span>
<span class="m">07</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;Please enter a filename: &quot;</span>
<span class="m">08</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>name
<span class="m">09</span>
<span class="m">10</span><span class="w"> </span><span class="c1">##### echo text stream and redirect</span>
<span class="m">11</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;This file logs commands that succeed&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>success.log
<span class="m">12</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;This file logs commands that fail (except this one)&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>error.log
<span class="m">13</span>
<span class="m">14</span><span class="w"> </span><span class="c1">########## Conditional Redirection ##########</span>
<span class="m">15</span><span class="w"> </span><span class="c1">### If $name is found, the ls $name command succeeds and</span>
<span class="m">16</span><span class="w"> </span><span class="c1">###    the command output will go into the success.log file.</span>
<span class="m">17</span><span class="w"> </span><span class="c1">### If $name is not found, the &quot;not found&quot; output goes into error.log</span>
<span class="m">18</span><span class="w"> </span>ls<span class="w"> </span><span class="nv">$name</span><span class="w"> </span><span class="m">1</span>&gt;&gt;<span class="w"> </span>success.log<span class="w"> </span><span class="m">2</span>&gt;&gt;<span class="w"> </span>error.log<span class="p">;</span>
<span class="m">19</span>
<span class="m">20</span><span class="w"> </span><span class="c1">########## Conditional Redirection ##########</span>
<span class="m">21</span><span class="w"> </span><span class="c1">### If $name is found, the &quot;echo $name&quot; command succeeds and</span>
<span class="m">22</span><span class="w"> </span><span class="c1">###    its output will go into the success.log file.</span>
<span class="m">23</span><span class="w"> </span><span class="c1">### If $name is not found, the &quot;not found&quot; message goes into error.log.</span>
<span class="m">24</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;We looked for file </span><span class="nv">$name</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">1</span>&gt;&gt;<span class="w"> </span>success.log<span class="w"> </span><span class="m">2</span>&gt;&gt;<span class="w"> </span>error.log
</pre></div>
</div>
<p>From the <code class="docutils literal notranslate"><span class="pre">redirect.sh</span></code> code above, we see that:</p>
<ol class="arabic simple">
<li><p>Line #7 is an echo line that prompts the user for input.</p></li>
<li><p>Line #8 takes the user input from standard input (the <code class="docutils literal notranslate"><span class="pre">stdin</span></code> stream, the keyboard) and saves it to a variable called <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
<li><p>Line #11 and 12, we see that this script actually produced two files: <code class="docutils literal notranslate"><span class="pre">success.log</span></code> and <code class="docutils literal notranslate"><span class="pre">error.log</span></code>. These two lines are comment messages into each of the two log files and they are overwrite redirection. So, each time when we run the script, they will create the two new files of <code class="docutils literal notranslate"><span class="pre">success.log</span></code> and <code class="docutils literal notranslate"><span class="pre">error.log</span></code>.</p></li>
<li><p>Line #18 and line #24 perform conditional redirection. When the command succeeds, <code class="docutils literal notranslate"><span class="pre">1&gt;&gt;</span></code> takes effect. When the command fails, <code class="docutils literal notranslate"><span class="pre">2&gt;&gt;</span></code> takes effect. This “conditional” action is achieved in line #18 and 24 by using file descriptors (<code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">2</span></code>) along with redirection (append) operator <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>.</p></li>
</ol>
<ol class="upperalpha simple" start="4">
<li><p>File descriptor</p></li>
</ol>
<p>A file descriptor (or, file handle) is a unique number that points to a data stream. The three file descriptors of most interest to us are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>File Descriptor</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Abbreviation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Standard Input</p></td>
<td><p>STDIN</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Standard Output</p></td>
<td><p>STDOUT</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Standard Error</p></td>
<td><p>STDERR</p></td>
</tr>
</tbody>
</table>
<p>Graphically, these three standard data streams work like this:</p>
<a class="reference internal image-reference" href="../_images/std_streams.png"><img alt="Data streams" src="../_images/std_streams.png" style="width: 576.0px; height: 340.5px;" /></a>
<p>For example, at line #18, <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">$name</span> <span class="pre">1&gt;&gt;</span> <span class="pre">success.log</span> <span class="pre">2&gt;&gt;</span> <span class="pre">error.log;</span></code>, we see that the command is <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">$name</span></code>. <code class="docutils literal notranslate"><span class="pre">$name</span></code> performs variable substitution to reference the content of variable <code class="docutils literal notranslate"><span class="pre">name</span></code>. In our case above, we enter “a01.txt” at the read prompt, so the value of <code class="docutils literal notranslate"><span class="pre">$name</span></code> is “a01.txt”, which is a file that exists. Therefore, the shell will output the successful listing (<code class="docutils literal notranslate"><span class="pre">ls</span></code>) result to the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> data stream (file descriptor 1), which we redirect to <code class="docutils literal notranslate"><span class="pre">success.log</span></code> by using <code class="docutils literal notranslate"><span class="pre">1&gt;&gt;</span></code>, and the <code class="docutils literal notranslate"><span class="pre">2&gt;&gt;</span> <span class="pre">error.log</span></code> part is ignored. In the case that the file does not exist, <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">$name</span></code> will result in an error (<code class="docutils literal notranslate"><span class="pre">stderr</span></code>), which data stream has file descriptor number 2. We then redirect it to <code class="docutils literal notranslate"><span class="pre">error.log</span></code> by using <code class="docutils literal notranslate"><span class="pre">2&gt;&gt;</span> <span class="pre">error.log</span></code>, and the <code class="docutils literal notranslate"><span class="pre">1&gt;&gt;</span></code> part is ignored.</p>
<p>In line#18 of <code class="docutils literal notranslate"><span class="pre">redirect.sh</span></code>, we use file descriptors (fd) number 1 (<code class="docutils literal notranslate"><span class="pre">stdout</span></code>) and 2 (<code class="docutils literal notranslate"><span class="pre">stderr</span></code>) to point to the data source and then use the redirection operator <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> to direct the text stream to files. This creates a conditional redirection much like a shorthand for <code class="docutils literal notranslate"><span class="pre">if</span></code> statement.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">nano</span></code> to open <code class="docutils literal notranslate"><span class="pre">redirect.sh</span></code> and examine the code closely. Make sure you understand how conditional redirection works using file descriptor 1 and 2.</p>
<p>1.3 Create Conditional Redirection</p>
<p>With our understanding in user input and conditional redirection, we are ready to modify the script file <code class="docutils literal notranslate"><span class="pre">q01.sh</span></code>. Let us run the code, read the code, and finally modify the code.</p>
<ol class="upperalpha simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">q01.sh</span></code></p></li>
</ol>
<p>Before we modify it, let us run <code class="docutils literal notranslate"><span class="pre">./q01.sh</span></code> to take a look at the results. We should get something like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>OK,<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>where<span class="w"> </span>bin<span class="w"> </span>was<span class="w"> </span>found
Oh<span class="w"> </span>no!<span class="w">  </span>bin<span class="w"> </span>wasn<span class="s1">&#39;t found here.</span>
<span class="s1">Found bin</span>
<span class="s1">Did NOT find bin</span>
<span class="s1">ls: cannot access &#39;</span>/home/chen_admin/bin<span class="err">&#39;</span>:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
<span class="m">4</span><span class="w"> </span>/home/chen_user/bin
chen_user@localhost:~/class/a03/q01$
</pre></div>
</div>
<p>We don’t always want the output to be displayed on the screen like this. Log files are preferred in most cases because they are easier to read, process, and retrieve.</p>
<ol class="upperalpha simple" start="2">
<li><p>Check out the code</p></li>
</ol>
<p>Now we <code class="docutils literal notranslate"><span class="pre">nano</span> <span class="pre">q01.sh</span></code> and see the script looks like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w"> </span><span class="c1">#!/bin/bash</span>
<span class="m">2</span><span class="w"> </span><span class="c1"># echo &quot;What file would you like to look for (good choices are bin, test, and public_html)&quot;</span>
<span class="m">3</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;bin&quot;</span><span class="w">              </span><span class="c1"># use bin as the default to start, we really want to read this from the terminal</span>
<span class="m">4</span>
<span class="m">5</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;OK, This is a list of where </span><span class="nv">$file</span><span class="s2"> was found&quot;</span><span class="w">      </span><span class="c1"># This should output to success.log</span>
<span class="m">6</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Oh no!  </span><span class="nv">$file</span><span class="s2"> wasn&#39;t found here.&quot;</span><span class="w">                 </span><span class="c1"># This should output to error.log</span>
<span class="m">7</span>
<span class="m">8</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Found </span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w">                                      </span><span class="c1"># This should output to success.log</span>
<span class="m">9</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Did NOT find </span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w">                               </span><span class="c1"># This should output to error.log</span>
<span class="m">10</span>
<span class="m">11</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>homedir<span class="w"> </span><span class="k">in</span><span class="w"> </span>/home/*<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="m">12</span><span class="w">     </span>ls<span class="w"> </span>--directory<span class="w"> </span>--size<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$homedir</span><span class="s2">/</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w">       </span><span class="c1"># This output should go to success.log (if found) or error.log (if not found)</span>
<span class="m">13</span><span class="w"> </span><span class="k">done</span>
</pre></div>
</div>
<p>We see that line #1 is a shebang line, line #2 is commented out but it has a command <code class="docutils literal notranslate"><span class="pre">echo</span></code> in there. It would be interesting to see what will happen if we uncomment it. We would want line #5, 6, 8, and 9 to be redirected to the log files. Line #11 to 13 is a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, which will go through the files in <code class="docutils literal notranslate"><span class="pre">/home</span></code> directory. We can move on to modify this piece of code by performing the following tasks:</p>
<ol class="upperalpha simple" start="3">
<li><p>Enable user input</p></li>
</ol>
<p>Modify <code class="docutils literal notranslate"><span class="pre">q01.sh</span></code> so that it will:</p>
<p>Enable user prompt:</p>
<p>Modify the code (#2) so that it will prompt for the user to input a filename. In this script, we are suggested to monitor the user directories that we have created, which is a good idea since we know for sure if they exist or not.</p>
<p>Enable user input:</p>
<p>To take user input, we use the <code class="docutils literal notranslate"><span class="pre">read</span></code> command, which will scan <code class="docutils literal notranslate"><span class="pre">STDIN</span></code> for user input from the keyboard. Right now, the input is hardcoded to default to the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory, which is not what we want. We want the script to take user input. Modify line #6 can help us achieve this purpose.</p>
<p>Set up redirection:</p>
<p>Simple redirection:</p>
<p>Modify line #5, 6, 8, and 9 to properly redirect text streams to the log files. The messages would go into the right logs as specified in the comments after the commands.</p>
<p>Conditional redirection:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">homedir</span> <span class="pre">in</span> <span class="pre">/home/*</span></code> will parse through directory <code class="docutils literal notranslate"><span class="pre">/home</span></code> and assign each of the filenames (user home directories in this case) to the loop variable <code class="docutils literal notranslate"><span class="pre">homedir</span></code> (home directory). Each of the user home directories will then be listed for the <code class="docutils literal notranslate"><span class="pre">$file</span></code> user input (<code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">$homedir/$file</span></code>). After all user home directories are iterated, the loop is “done.”</p>
<p>If the user of this script inputs “bin” for search, then since only some of the user accounts have the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory created in user home, some <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">$homedir/bin/</span></code> will be successful and some will say “No such file or directory”. Here our job is to modify the line of command (line #24) inside the loop so that the <code class="docutils literal notranslate"><span class="pre">ls</span></code> results will be conditionally sent to either <code class="docutils literal notranslate"><span class="pre">error.log</span></code> or <code class="docutils literal notranslate"><span class="pre">success.log</span></code>. The rules of the conditional redirection are:</p>
<ul class="simple">
<li><p>Any standard (successful) output (<code class="docutils literal notranslate"><span class="pre">STDOUT</span></code>) messages are redirected to the file <code class="docutils literal notranslate"><span class="pre">success.log</span></code></p></li>
<li><p>Any error output (<code class="docutils literal notranslate"><span class="pre">STDERR</span></code>) messages are redirected to the file <code class="docutils literal notranslate"><span class="pre">error.log</span></code></p></li>
</ul>
</section>
<section id="check-your-work">
<h2><span class="section-number">4.1.15. </span>Check Your Work<a class="headerlink" href="#check-your-work" title="Link to this heading"></a></h2>
<p>Make a copy of the working script <code class="docutils literal notranslate"><span class="pre">q01.sh</span></code> as <code class="docutils literal notranslate"><span class="pre">finder_v01.sh</span></code> to the <code class="docutils literal notranslate"><span class="pre">backup</span></code> directory.</p>
<p>Once this script is working as you check the logs are correctly created, save a copy of <code class="docutils literal notranslate"><span class="pre">q01.sh</span></code> in your <code class="docutils literal notranslate"><span class="pre">~/backup</span></code> directory as <code class="docutils literal notranslate"><span class="pre">finder_v01.sh</span></code>.</p>
<p>Modify <code class="docutils literal notranslate"><span class="pre">a01.txt</span></code>: You know what to do.
Run the check script to see how you have done in this Part.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>“In UNIX (and therefore Linux), everything is a file.” So regular text files, directories, text/data streams, or even peripherals (device files), are treated as files by the operating system. In this regard, <code class="docutils literal notranslate"><span class="pre">STDIN</span></code>, <code class="docutils literal notranslate"><span class="pre">STDOUT</span></code>, and <code class="docutils literal notranslate"><span class="pre">STDERR</span></code> are treated as files and each given a file descriptor (fd). If you are intrigued by this statement, check out Wikipedia and other sources to dig deeper. For example, what does this statement mean in the file system? And what does it mean from the perspective of data stream and name space? As you may find out, technology can be philosophically amazing. ^^
When the operating system opens a “file”, a file descriptor is assigned to it so that the open file is kept in track. In C language, it is called a file handle.</p>
</div>
</section>
<section id="tile-two-terminals">
<h2><span class="section-number">4.1.16. </span>Tile two terminals<a class="headerlink" href="#tile-two-terminals" title="Link to this heading"></a></h2>
<p>It is often useful to open two terminal windows, one for editing and one for testing your code. Tile the terminal windows in large enough size so you can see the chunks and structure of the scripts, which gives you a better idea about the logic of your code blocks (paragraphs). After all, programming languages are languages, and we will learn better by seeing they have pages, paragraphs, sentences, and vocabulary just like natural languages.</p>
</section>
<section id="o">
<h2><span class="section-number">4.1.17. </span>^-O<a class="headerlink" href="#o" title="Link to this heading"></a></h2>
<p>You can use <code class="docutils literal notranslate"><span class="pre">^-O</span></code> to save your modifications in the editing terminal without exiting <code class="docutils literal notranslate"><span class="pre">nano</span></code>. <code class="docutils literal notranslate"><span class="pre">^-O</span></code> will save the file and you still remain in editing mode to continue with testing in the other terminal.</p>
<p>It is always a good idea to backup your work. By default, Microsoft Word automatically keeps a copy of your file every 10 minutes, which is probably a good indicator of how much time your clients and you can tolerate a loss of work in case of a technical issue.</p>
</section>
<section id="part-2-environment-envs-and-aliases-at-user-level">
<h2><span class="section-number">4.1.18. </span>Part 2. Environment: ENVs And Aliases At User Level<a class="headerlink" href="#part-2-environment-envs-and-aliases-at-user-level" title="Link to this heading"></a></h2>
<p>The idea here is that you are creating your own working environment. The aliases and environment variables you are creating here are administrative tools widely used in IT workplaces. The common locations for configuring Linux environment include the <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> and <code class="docutils literal notranslate"><span class="pre">.profile</span></code> files under the user home directory. In Ubuntu, it is suggested to use <code class="docutils literal notranslate"><span class="pre">~/.bash_aliases</span></code> to include additional aliases. If you define the hidden file <code class="docutils literal notranslate"><span class="pre">~/.bash_aliases</span></code> and source it from <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, it will be executed every time your log in.</p>
<p>Our goal in this next set of steps is to personalize your Linux environment by loading certain functionalities you choose every time you log in.</p>
<p>Use the directory <code class="docutils literal notranslate"><span class="pre">~/class/a03/q02</span></code> to record your answers for this part of the assignment.</p>
</section>
<section id="create-environment-variables-and-aliases">
<h2><span class="section-number">4.1.19. </span>2.1 Create Environment Variables And Aliases<a class="headerlink" href="#create-environment-variables-and-aliases" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>Create the environment definition file</p>
<blockquote>
<div><p>To help us do this with less typing, change to your home directory and use <code class="docutils literal notranslate"><span class="pre">nano</span></code> to create a file called <code class="docutils literal notranslate"><span class="pre">myenv</span></code>.</p>
</div></blockquote>
</li>
<li><p>Within <code class="docutils literal notranslate"><span class="pre">myenv</span></code>, create two environment variables</p>
<blockquote>
<div><ul>
<li><p>Define an environment variable called <code class="docutils literal notranslate"><span class="pre">MYTMP</span></code> that represents your <code class="docutils literal notranslate"><span class="pre">~/tmp</span></code> directory.</p></li>
<li><p>Define a second environment variable <code class="docutils literal notranslate"><span class="pre">A3</span></code> that represents your <code class="docutils literal notranslate"><span class="pre">~/class/a03</span></code> directory. You can use the <code class="docutils literal notranslate"><span class="pre">export</span></code> command to perform the definitions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">MY_VAR</span><span class="o">=</span>VALUE
</pre></div>
</div>
</li>
<li><p>Check your environment variable using the <code class="docutils literal notranslate"><span class="pre">printenv</span></code> command (you need to <code class="docutils literal notranslate"><span class="pre">source</span></code> the definition file first):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chen_user@vma50:~/class/a03/q02$<span class="w"> </span>printenv<span class="w"> </span>A3
/home/chen_user/class/a03
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Define three aliases</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vs</span></code> – views the contents of <code class="docutils literal notranslate"><span class="pre">success.log</span></code> using <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">$MYTMP/success.log</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ve</span></code> – views the contents of <code class="docutils literal notranslate"><span class="pre">error.log</span></code> using <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">$MYTMP/error.log</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rl</span></code> – removes the <code class="docutils literal notranslate"><span class="pre">$MYTMP/error.log</span></code> and <code class="docutils literal notranslate"><span class="pre">$MYTMP/success.log</span></code> files.</p></li>
</ul>
<p>The syntax for defining aliases is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">alias</span><span class="w"> </span><span class="nv">alias_name</span><span class="o">=</span><span class="s1">&#39;command_to_run&#39;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>To execute the <code class="docutils literal notranslate"><span class="pre">myenv</span></code> file</p>
<blockquote>
<div><p>To execute the <code class="docutils literal notranslate"><span class="pre">myenv</span></code> file and make your environment variable and alias definitions available while you are in the CLI (terminal), use the <code class="docutils literal notranslate"><span class="pre">source</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>myenv
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Now you can try the five variables</p>
<blockquote>
<div><p>Now you can try the five variables in your CLI to make sure they work.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span><span class="nv">$A3</span><span class="w">  </span><span class="c1"># will take you to the directory as defined by A3</span>
<span class="nb">cd</span><span class="w"> </span><span class="nv">$MYTMP</span><span class="w">  </span><span class="c1"># will take you to the directory as defined by MYTMP</span>
vs<span class="w">  </span><span class="c1"># should show you the content of success.log in $MYTMP or give you an error if the directory or file is not available.</span>
chen_user@vma50:~/class/a03/q02$<span class="w"> </span>vs
cat:<span class="w"> </span>/home/chen_user/tmp/success.log:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory

ve
rl
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</section>
<section id="create-bash-aliases">
<h2><span class="section-number">4.1.20. </span>2.2 Create .Bash_aliases<a class="headerlink" href="#create-bash-aliases" title="Link to this heading"></a></h2>
<p>Instructions</p>
<p>Here we want to create a <code class="docutils literal notranslate"><span class="pre">.bash_aliases</span></code> file in your home directory that sources the <code class="docutils literal notranslate"><span class="pre">myenv</span></code> file every time you log in. This can be done using <code class="docutils literal notranslate"><span class="pre">nano</span></code> as follows:</p>
<ul>
<li><p>Change to your home directory.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">nano</span> <span class="pre">.bash_aliases</span></code> to enter the following bash statements into a <code class="docutils literal notranslate"><span class="pre">.bash_aliases</span></code> file and then save the file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#</span>
<span class="c1">#       Add my environment variables if the file exists.</span>
<span class="c1">#</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>~/myenv<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span><span class="nb">source</span><span class="w"> </span>~/myenv
<span class="k">fi</span>
</pre></div>
</div>
</li>
</ul>
<p>Check Your Work</p>
<p>Test the work above by opening another terminal window and then run <code class="docutils literal notranslate"><span class="pre">printenv</span></code> and <code class="docutils literal notranslate"><span class="pre">alias</span></code>. These commands should show you the environment variables and aliases you created. Changing to your <code class="docutils literal notranslate"><span class="pre">~/class/a03/q02</span></code> directory and running <code class="docutils literal notranslate"><span class="pre">check02.sh</span></code> will help you figure out what is wrong if the above doesn’t work as expected. Note that if you find any error with the check script and go back to modify your <code class="docutils literal notranslate"><span class="pre">myenv</span></code> file, you need to <code class="docutils literal notranslate"><span class="pre">source</span></code> it to populate the variables in your personal environment before checking again. When you are confident you have it working, enter DONE in the <code class="docutils literal notranslate"><span class="pre">~/class/a03/q02/a02.txt</span></code> file.</p>
</section>
<section id="part-3-putting-it-all-together">
<h2><span class="section-number">4.1.21. </span>Part 3. Putting It All Together<a class="headerlink" href="#part-3-putting-it-all-together" title="Link to this heading"></a></h2>
</section>
<section id="putting-it-all-together">
<h2><span class="section-number">4.1.22. </span>Putting It All Together<a class="headerlink" href="#putting-it-all-together" title="Link to this heading"></a></h2>
<p>Use the directory <code class="docutils literal notranslate"><span class="pre">~/class/a03/q03</span></code> to record your answers for this part of the assignment.</p>
<ol class="upperalpha">
<li><p>Start by copying your <code class="docutils literal notranslate"><span class="pre">q01/q01.sh</span></code> file to <code class="docutils literal notranslate"><span class="pre">q03.sh</span></code></p>
<blockquote>
<div><p>If you have done the aliases and environment variables as defined in <code class="docutils literal notranslate"><span class="pre">q02</span></code>, you can achieve this copying task by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span><span class="nv">$A3</span>/q01/q01.sh<span class="w"> </span><span class="nv">$A3</span>/q03/q03.sh
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Modify script <code class="docutils literal notranslate"><span class="pre">q03.sh</span></code></p>
<blockquote>
<div><p>Modify script <code class="docutils literal notranslate"><span class="pre">q03.sh</span></code> so that it creates the files <code class="docutils literal notranslate"><span class="pre">success.log</span></code> and <code class="docutils literal notranslate"><span class="pre">error.log</span></code> in your <code class="docutils literal notranslate"><span class="pre">$MYTMP</span></code> directory, rather than in the <code class="docutils literal notranslate"><span class="pre">q03</span></code> directory. Note that here we use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to parse through all user directories in system <code class="docutils literal notranslate"><span class="pre">/home</span></code> and redirect (<code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>) the results (li) successfully found or not found with an error.</p>
<p>Use file descriptor (fd) and redirection operator (<code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>) to achieve conditional redirection.</p>
</div></blockquote>
</li>
<li><p>Add two statements to the bottom of your <code class="docutils literal notranslate"><span class="pre">q03.sh</span></code> scripts</p>
<blockquote>
<div><p>Add two statements to the bottom of your <code class="docutils literal notranslate"><span class="pre">q03.sh</span></code> scripts that will use your <code class="docutils literal notranslate"><span class="pre">vs</span></code> and <code class="docutils literal notranslate"><span class="pre">ve</span></code> aliases and redirect their output to <code class="docutils literal notranslate"><span class="pre">$MYTMP/summary03.log</span></code> as follows (because we source the <code class="docutils literal notranslate"><span class="pre">myenv</span></code> file, we can use aliases in our script):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vs<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$MYTMP</span>/summary03.log
ve<span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$MYTMP</span>/summary03.log
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Make <code class="docutils literal notranslate"><span class="pre">q03.sh</span></code> available when logging in</p>
<blockquote>
<div><p>Finally, we need to make <code class="docutils literal notranslate"><span class="pre">q03.sh</span></code> work independently of where we run it from every time we log in using our individual account (but not to other users). To do that, we need to copy our final version to our personal <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>q03.sh<span class="w"> </span>~/backup/finder_v02.sh
cp<span class="w"> </span>q03.sh<span class="w"> </span>~/bin/finder.sh
</pre></div>
</div>
<p>If you have set up your environment and script correctly, <code class="docutils literal notranslate"><span class="pre">finder.sh</span></code> will run from any directory. When it is run, it should create a file named <code class="docutils literal notranslate"><span class="pre">summary03.log</span></code> in the directory <code class="docutils literal notranslate"><span class="pre">~/tmp</span></code> each time it runs. This file should contain the results of both your <code class="docutils literal notranslate"><span class="pre">error.log</span></code> and <code class="docutils literal notranslate"><span class="pre">success.log</span></code> files.</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">finder.sh</span></code> and look at the content of the file <code class="docutils literal notranslate"><span class="pre">~/tmp/summary03.log</span></code> to see if it contains what you expect it to contain. Running <code class="docutils literal notranslate"><span class="pre">./check03.sh</span></code> from within your <code class="docutils literal notranslate"><span class="pre">q03</span></code> directory to verify that everything is the right place and working properly or give you an idea of what might be wrong if it is not. Enter DONE in the <code class="docutils literal notranslate"><span class="pre">~/class/a03/q03/a03.txt</span></code> file when you are confident you have it working.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The syntax of <code class="docutils literal notranslate"><span class="pre">cp</span></code> is <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">[options]</span> <span class="pre">SOURCE_FILENAME</span> <span class="pre">TARGET_FILENAME</span></code> (will rename), or <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">[options]</span> <span class="pre">SOURCE_FILE</span> <span class="pre">TARGET_DIRECTORY</span></code> (will not rename).</p>
</div>
</div></blockquote>
</li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="week3.html" class="btn btn-neutral float-left" title="4. Week 3" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="02.homework3.html" class="btn btn-neutral float-right" title="4.2. Homework 03: Grep, Alias, Env Var, &amp; Function" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>